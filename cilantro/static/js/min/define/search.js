var __hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype;return a},__indexOf=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1},__bind=function(a,b){return function(){return a.apply(b,arguments)}};define(["common/views/collection","common/models/state","common/views/state"],function(a,b,c){var d,e,f,g,h;e=function(){function a(){a.__super__.constructor.apply(this,arguments)}__extends(a,b.Model);return a}(),f=function(){function a(){a.__super__.constructor.apply(this,arguments)}__extends(a,Backbone.Collection),a.prototype.model=e,a.prototype.url=App.urls.criteria,a.prototype.query=function(a){return $.get(this.url,{q:a},__bind(function(a){return this.each(function(b){var c;return(c=b.id,__indexOf.call(a,c)>=0)?b.enable():b.disable()})},this))};return a}(),g=function(){function a(){a.__super__.constructor.apply(this,arguments)}__extends(a,c.View),a.prototype.template=_.template('<span class="name"><%= name %></span>\n            <br><span class="info"><%= domain.name %></span>'),a.prototype.events={click:"click"},a.prototype.render=function(){this.el.html(this.template(this.model.toJSON()));return this},a.prototype.click=function(){App.hub.publish("concept/request",this.model.id);return!1};return a}(),h=function(){function b(){this.reposition=__bind(this.reposition,this),b.__super__.constructor.apply(this,arguments)}__extends(b,a.View),b.prototype.el="#concept-search-results",b.prototype.viewClass=g,b.prototype.noResults=$('<div class="info">No results found</div>').hide(),b.prototype.elements={".content":"content"},b.prototype.events={mouseenter:"mouseenter",mouseleave:"mouseleave"},b.prototype.initialize=function(a){this.input||(this.input=new d,this.input.results=this,this.content.append(this.noResults)),this.render();return b.__super__.initialize.apply(this,arguments)},b.prototype.insertChild=function(a){return this.content.append(a.el)},b.prototype.render=function(){this.el.appendTo("body"),this.reposition(),$(window).bind("resize",this.reposition);return this},b.prototype.reposition=function(){var a,b,c,d;d=this.el.outerWidth(),b=this.input.el.offset(),a=this.input.el.outerHeight(),c=this.input.el.outerWidth();return this.el.css({top:b.top+a+5,left:b.left-(d-c)/2})},b.prototype.query=function(a){var b;b=this.collection.query(a);return b.success(__bind(function(a){return a.length?this.noResults.hide():this.noResults.show()},this))},b.prototype.mouseenter=function(){return this.entered=!0},b.prototype.mouseleave=function(){this.entered=!1;if(!this.input.focused)return this.hide()},b.prototype.show=function(){return this.el.fadeIn("fast")},b.prototype.hide=function(){return this.el.fadeOut("fast")};return b}(),d=function(){function a(){a.__super__.constructor.apply(this,arguments)}__extends(a,Backbone.View),a.prototype.el="#concept-search",a.prototype.elements={":parent":"form"},a.prototype.events={focus:"focus",blur:"blur",keyup:"keyup"},a.prototype.focus=function(){this.focused=!0;if(this.el.val()!=="")return this.results.show()},a.prototype.blur=function(){this.focused=!1;if(!this.results.entered)return this.results.hide()},a.prototype.keyup=function(){this.results.show(),clearTimeout(this._searchTimer);return this._searchTimer=setTimeout(__bind(function(){return this.results.query(this.el.val())},this),200)};return a}();return $(function(){var a,b;a=new f,b=new h({collection:a});return a.fetch()})})